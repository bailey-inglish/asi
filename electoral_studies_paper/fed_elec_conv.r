# File name: fed_elec_conv.r
# Purpose:   Takes copy/paste text of table from Federal Elections and converts
#            it to a .csv file.
# Author:    Bailey Inglish

#### PART 1: IMPORTS ####
# Libaries and datasets
library(tidyverse)

setwd("electoral_studies_paper")

abbr_conv <- read_csv("raw_data/fips_name_abbr.csv")

# Inputs
raw_text <- tribble(
  ~year, ~input,
  2004, "State Democratic Candidates Republican Candidates Other Candidates AL 1,997,376 3,498,251 19,647 AK 318,523 553,878 48,508 AS 6,656 5,472 0 AZ 1,895,557 3,737,257 212,893 AR 1,477,306 1,388,774 19,454 CA 19,924,911 15,096,569 1,077,420 CO 3,078,203 3,073,758 124,934 CT 2,588,582 1,781,509 62,142 DE 305,868 417,638 7,729 DC 404,997 39,552 4,250 FL 9,386,069 10,956,682 324,447 GA 3,774,708 5,598,273 90,638 GU 31,051 0 837 HI 807,221 429,806 23,903 ID 352,158 1,310,397 12,250 IL 9,164,279 6,008,312 231,916 IN 3,465,069 3,765,050 82,367 IA 1,778,883 2,612,785 52,629 KS 1,132,300 2,241,113 99,748 KY 2,165,673 2,960,325 29,489 LA 2,426,066 3,114,065 48,198 ME 815,222 613,411 22,295 MD 4,149,975 2,703,990 111,851 MA 3,863,784 1,506,348 123,211 MI 4,721,618 4,602,340 146,352 MN 2,844,638 2,582,789 122,641 MS 794,334 1,343,570 130,444 MO 3,610,106 4,403,569 91,114 MT 319,316 552,139 23,220 NE 485,025 1,027,929 30,204 NV 1,225,907 1,124,041 81,140 NH 805,566 1,162,108 18,716 NJ 3,632,822 3,184,787 78,677 NM 755,842 734,735 8,626 NY 12,156,311 6,796,927 1,363,091 NC 4,828,240 5,495,747 62,173 ND 508,325 420,888 5,130 OH 7,217,031 8,974,541 46,040 OK 1,489,745 2,598,258 197,211 OR 3,023,579 2,193,630 172,429 PA 7,750,460 8,284,004 446,505 PR 0 0 1,959,553 RI 539,075 282,004 18,230 SC 1,852,562 2,708,309 93,198 SD 550,421 609,255 9,195 TN 2,068,436 2,545,196 42,425 TX 5,546,672 8,539,451 283,245 UT 861,782 1,810,785 75,860 VT 422,723 270,849 230,953 VI 17,879 1,512 7,540 VA 2,477,929 3,534,381 190,064 WA 4,668,660 3,604,971 134,099 WV 741,937 726,820 8,786 WI 4,490,738 4,160,122 117,503 WY 170,765 299,736 11,961 Total: 155,888,881 157,988,608 9,037,081",
  2006, "State Democratic Candidates Republican Candidates Other Candidates AL 502,046 627,501 10,605 AK 93,879 132,743 8,023 AS 5,195 4,493 1,345 AZ 1,291,400 1,585,644 142,888 AR 456,569 306,442 0 CA 9,796,453 6,305,220 735,619 CO 832,888 623,784 82,236 CT 1,093,703 529,093 586,723 DE 268,132 213,631 24,030 DC 111,726 0 3,051 FL 4,490,516 4,008,960 146,000 GA 932,143 1,138,048 116 GU 32,677 0 1,201 HI 430,140 244,231 6,415 ID 177,376 248,105 19,825 IL 1,987,114 1,442,969 23,625 IN 812,496 2,003,338 192,199 IA 492,937 522,388 18,363 KS 369,191 459,267 16,669 KY 601,723 611,780 40,023 LA 357,926 579,702 27,034 ME 462,665 565,753 51,428 MD 2,064,918 1,334,044 83,379 MA 3,133,045 860,082 96,020 MI 4,074,763 3,184,462 169,419 MN 2,431,470 1,760,289 189,987 MS 473,330 692,707 45,581 MO 2,047,513 2,056,287 121,981 MT 358,761 435,407 18,471 NE 640,298 548,105 0 NV 526,675 582,818 47,906 NH 209,434 189,615 3,620 NJ 2,408,627 1,900,951 77,334 NM 707,489 411,651 494 NY 5,147,895 2,333,868 1,143,668 NC 1,026,915 913,893 0 ND 293,080 139,104 3,589 OH 4,339,106 3,631,427 9,898 OK 372,888 518,025 14,281 OR 765,853 557,491 34,090 PA 4,622,075 3,416,941 55,415 RI 471,138 220,857 66,838 SC 461,600 599,615 24,991 SD 230,468 97,864 5,230 TN 1,740,837 1,729,458 78,826 TX 3,446,071 4,772,926 345,840 UT 421,942 648,473 70,527 VT 139,815 201,947 183,383 VI 19,593 0 11,212 VA 2,122,709 2,389,067 155,905 WA 2,428,754 1,630,111 78,925 WV 560,098 345,936 8,663 WI 2,442,370 1,670,370 88,970 WY 149,995 228,510 8,000 Total: 75,878,420 62,155,393 5,379,861",
  2008, "State Democratic Candidates Republican Candidates Other Candidates AL 2,284,237 3,692,832 38,209 AK 417,921 500,594 42,383 AS 7,499 4,350 570 AZ 2,090,012 2,251,909 107,248 AR 1,642,469 853,213 389,882 CA 15,652,198 9,527,153 704,628 CO 3,779,450 3,055,283 182,372 CT 1,906,533 1,134,213 133,450 DE 659,432 528,406 8,165 DC 474,176 17,367 21,781 FL 7,716,905 7,837,791 257,220 GA 6,369,529 6,940,438 159,908 GU 28,247 0 884 HI 645,827 203,106 22,466 ID 716,119 1,152,220 69,415 IL 10,211,395 5,512,973 376,082 IN 2,763,002 2,586,225 78,677 IA 2,530,065 1,940,626 52,515 KS 1,426,195 2,116,781 111,888 KY 2,360,199 2,957,460 59,622 LA 2,169,761 2,609,758 123,992 ME 1,133,336 1,017,771 14,587 MD 3,306,705 1,722,401 100,442 MA 6,121,849 2,353,359 206,138 MI 8,427,605 5,804,002 429,469 MN 4,398,463 3,556,741 645,425 MS 1,767,382 2,018,038 1,259,691 MO 2,854,927 2,758,832 132,930 MT 735,886 680,602 32,372 NE 915,660 1,419,346 34,184 NV 991,056 796,375 88,671 NH 1,108,031 925,497 47,204 NJ 6,078,467 4,536,052 174,143 NM 1,434,685 986,437 47,252 NY 8,662,969 4,552,864 815,614 NC 6,685,933 5,917,501 194,418 ND 335,855 287,989 6,742 MP 307 2,117 7,737 OH 5,692,155 5,169,318 221,217 OK 1,533,846 2,526,070 86,491 OR 2,937,854 1,979,554 360,469 PA 6,485,531 5,176,690 142,335 PR 0 0 1,908,125 RI 920,885 400,338 27,587 SC 2,572,599 3,051,133 42,558 SD 664,854 468,804 7,997 TN 3,050,215 4,036,332 239,672 TX 9,897,396 13,020,714 600,382 UT 721,431 1,099,947 67,831 VT 467,465 98,974 56,758 VI 28,153 0 69 VA 6,181,647 4,544,522 135,740 WA 3,476,164 2,418,363 56,814 WV 1,183,492 865,434 12,393 WI 3,060,747 2,537,380 160,464 WY 316,459 668,311 18,787 Total: 170,001,180 142,820,506 11,324,065",
  2010, "State Democratic Candidates Republican Candidates Other Candidates AL 934,576 1,882,626 36,044 AK 137,651 266,223 107,999 AS 6,182 4,422 356 AZ 1,303,848 1,906,125 196,656 AR 606,131 887,040 60,911 CA 10,366,648 8,412,974 868,111 CO 1,658,754 1,710,846 176,535 CT 1,240,151 956,317 94,849 DE 347,555 248,495 16,988 DC 117,990 8,109 6,557 FL 2,946,536 5,649,968 1,932,022 GA 1,936,863 3,018,046 69,029 GU 35,919 0 1,502 HI 503,658 209,066 17,980 ID 262,941 583,652 50,081 IL 5,237,280 5,176,443 532,893 IN 1,438,117 2,039,702 198,091 IA 851,560 1,315,629 55,465 KS 495,963 1,115,311 61,947 KY 1,106,371 1,600,075 3,948 LA 787,793 1,390,801 122,347 ME 316,156 248,170 42 MD 2,244,587 1,329,912 84,831 MA 1,335,738 808,305 80,212 MI 1,415,212 1,671,707 107,982 MN 1,002,026 970,741 117,824 MS 350,695 423,579 14,275 MO 1,497,800 2,157,450 209,324 MT 121,954 217,696 20,691 NE 137,524 327,986 20,036 NV 680,620 678,730 64,842 NH 368,108 503,483 34,083 NJ 1,024,730 1,055,299 41,555 NM 308,473 289,217 0 NY 7,618,622 4,225,756 1,946,939 NC 2,349,709 2,898,959 73,960 ND 159,497 311,491 4,961 MP 1,707 2,049 7,596 OH 3,114,409 4,221,817 304,146 OK 487,780 1,238,044 84,306 OR 1,558,876 1,223,206 89,862 PA 3,830,918 4,063,090 40,054 RI 185,711 126,951 22,405 SC 901,921 1,564,703 192,359 SD 146,589 381,650 19,134 TN 541,527 955,078 62,524 TX 1,450,197 3,058,228 237,188 UT 425,921 781,148 67,255 VT 305,287 149,102 19,310 VI 19,844 2,329 5,493 VA 911,116 1,186,098 92,627 WA 2,611,432 2,331,330 47,741 WV 511,215 513,098 20,008 WI 1,959,648 2,291,760 60,405 WY 45,768 131,661 9,540 Total: 72,263,804 80,721,693 8,813,821",
  2012, "State Democratic Candidates Republican Candidates Other Candidates AL 1,489,194 2,489,549 29,225 AK 205,567 349,972 34,760 AS 7659 0 5,417 AZ 3,008,768 3,469,774 237,451 AR 699,179 1,285,335 123,008 CA 23,111,612 14,083,857 625,946 CO 2,403,556 2,329,039 287,766 CT 2,582,464 1,730,041 224,730 DE 757,932 410,941 32,714 DC 513,734 21,381 37,212 FL 12,153,609 11,448,236 575,814 GA 3,222,696 4,182,786 48,155 GU 19765 12995 246 HI 861,155 419,540 7,024 ID 421,084 827,725 38,683 IL 5,763,214 4,343,034 193,899 IN 3,576,622 3,905,924 255,836 IA 1,594,931 1,457,122 66,976 KS 636,231 1,433,615 147,864 KY 1,470,712 2,288,864 73,690 LA 1,168,331 2,391,876 236,062 ME 922,025 773,657 411,898 MD 4,778,744 2,523,566 623,746 MA 5,698,230 3,343,999 173,525 MI 7,787,638 6,121,182 378,828 MN 4,961,746 3,398,608 232,797 MS 1,477,814 2,124,007 133,506 MO 3,837,475 4,012,185 309,356 MT 642,901 741,447 65,506 NE 911,299 1,426,933 17,234 NV 1,430,763 1,378,462 177,240 NH 710,486 641,554 41,348 NJ 6,071,704 4,237,359 158,764 NM 1,233,241 1,010,317 62,083 NY 12,822,779 5,957,238 1,450,545 NC 4,396,748 4,407,562 85,174 ND 417,859 519,878 21,812 MP 0 2503 9,829 OH 8,002,926 7,717,432 449,931 OK 853,871 1,748,197 58,739 OR 1,920,148 1,442,014 135,276 PA 8,805,176 7,899,636 238,944 PR 0 0 1,856,345 RI 783,390 465,352 43,271 SC 1,580,132 2,097,774 88,946 SD 298,828 418,250 8,166 TN 2,463,104 4,338,335 262,342 TX 9,452,951 13,439,250 630,680 UT 877,995 2,046,081 99,162 VT 407,839 233,139 241,005 VI 11,512 2131 5,527 VA 5,787,912 5,484,825 124,403 WA 5,463,759 4,015,725 79,450 WV 895,268 1,042,695 34,031 WI 4,613,104 4,190,087 140,704 WY 179,878 522,664 33,002 Total: 176,167,260 158,605,650 12,165,593",
  2014, "State Democratic Candidates Republican Candidates Other Candidates AL 331,764 1,500,139 67,067 AK 244,033 278,017 40,091 AS 5,328 4,306 612 AZ 577,947 817,178 72,492 AR 588,948 988,450 100,759 CA 4,067,737 2,950,679 114,005 CO 1,880,620 1,984,088 176,875 CT 596,390 409,513 61954 DE 267,906 183,969 13,780 DC 143,923 11,673 16,297 FL 2,130,626 2,713,451 154,478 GA 2,117,172 2,707,164 49,134 GU 20,693 14,956 113 HI 482,227 218,090 13,634 ID 311,652 560,668 7 IL 3,752,416 3,260,387 158718 IN 502,104 793,759 44,951 IA 1,003,559 1,184,440 62,035 KS 311,530 1,001,106 415,632 KY 1,092,849 1,693,944 46,701 LA 1,752,106 2,689,630 144,300 ME 495,474 641,554 59,326 MD 978,267 704,400 20,370 MA 2,765,386 1,100,548 32,854 MI 3,223,966 2,756,948 230,338 MN 2,038,965 1,763,766 142,336 MS 469,453 707,650 81,034 MO 513,600 838,283 74,420 MT 296,874 417,580 23,335 NE 355,361 688,452 32,054 NV 210,147 28,053 304,809 NH 498,653 467,726 2,700 NJ 2,050,824 1,732,289 69,062 NM 557,631 469,639 121 NY 1,788,105 1,257,412 606,190 NC 2,739,346 3,020,201 132,978 ND 95,678 138,100 14,892 MP 8,549 0 4,547 OH 1,179,587 1,770,923 49,651 OK 646,252 1,572,781 76,003 OR 1,592,676 1,121,756 197,888 PA 1,467,594 1,833,205 28,404 RI 416,451 215,405 1,299 SC 1,293,334 2,164,612 176,893 SD 174,941 324,575 56,215 TN 886,269 1,698,933 160,024 TX 3,071,403 5,546,123 484,331 UT 183,491 351,034 31,445 VT 123,349 59,432 8,723 VI 21,224 1,964 224 VA 2,010,842 2,348,528 201,747 WA 1,047,747 981,853 0 WV 338,844 524,643 29,590 WI 1,102,581 1,233,336 19,663 WY 67,180 234,592 31,718 Total: 56,891,574 64,681,903 5,138,819",
  2016, "State Democratic Candidates Republican Candidates Other Candidates AL 2,100,167 3,875,377 124,957 AK 263,673 456,624 217,950 AS 2,740 8,923 171 AZ 3,227,099 3,876,046 412,814 AR 892,443 2,107,271 307,061 CA 29,622,400 9,165,847 1,051,551 CO 3,973,371 3,706,420 545,046 CT 2,735,153 1,783,998 297,228 DE 469,157 357,428 37,869 DC 548,008 12,723 51,443 FL 12,612,113 14,186,707 760,465 GA 4,976,126 6,497,370 312,703 GU 18,345 15,617 206 HI 1,034,300 351,216 71,247 ID 587,006 1,305,616 158,170 IL 8,914,205 6,728,143 627,721 IN 3,244,974 4,424,266 456,631 IA 1,877,098 2,540,143 205,381 KS 1,124,380 2,097,634 314,046 KY 2,039,817 3,751,098 92,698 LA 2,433,901 4,325,285 164,126 ME 744,362 693,040 55,099 MD 4,974,035 2,877,814 363,512 MA 4,339,714 1,542,014 384,006 MI 4,462,819 4,522,945 484,425 MN 2,802,306 2,657,637 345,302 MS 935,027 1,381,524 75,079 MO 3,412,574 4,573,493 375,258 MT 383,628 564,598 56,752 NE 505,563 1,053,518 73,412 NV 1,569,367 1,505,241 237,568 NH 1,039,750 1,015,571 144,892 NJ 3,969,898 3,143,564 223,895 NM 822,166 662,791 93,488 NY 13,542,534 6,684,364 2,007,271 NC 6,460,142 7,205,333 365,680 ND 232,251 719,562 73,507 MP 0 0 10,605 OH 6,545,595 8,955,589 587,822 OK 1,081,508 2,711,719 241,056 OR 3,134,076 2,242,557 489,046 PA 8,697,049 9,048,672 550,933 PR 0 0 1,478,816 RI 516,173 321,867 57,629 SC 2,338,038 3,590,709 263,635 SD 354,408 730,400 24,914 TN 1,684,876 3,016,665 197,547 TX 7,038,403 9,562,652 896,697 UT 968,826 1,986,128 406,254 VT 635,230 199,006 89,974 VI 14,531 0 371 VA 3,840,899 3,612,453 313,527 WA 5,392,842 3,955,975 352,554 WV 413,243 934,388 53,141 WI 4,142,867 4,155,034 400,652 WY 131,439 330,595 45,591 Total: 179,822,615 167,731,170 18,029,394",
  2018, "State Democratic Candidates Republican Candidates Other Candidates AL 678,687 975,737 5,471 AK 131,199 149,779 1,188 AS 637 7,194 807 AZ 2,370,293 2,274,451 80,834 AR 312,978 556,339 19,981 CA 19,123,809 3,973,396 200,681 CO 1,343,211 1,079,772 90,923 CT 1,596,337 1,058,212 112,099 DE 444,738 262,511 9,171 DC 199,124 9,700 19,945 FL 7,396,700 7,774,922 39,859 GA 1,814,469 1,987,191 683 GU 19,193 15,398 399 HI 564,237 199,383 7,063 ID 207,303 367,993 20,428 IL 2,757,540 1,754,449 27,715 IN 2,023,657 2,405,978 109,079 IA 664,676 612,338 39,634 KS 464,380 563,190 22,752 KY 612,977 935,304 21,517 LA 553,184 835,715 71,694 ME 399,476 468,874 397,736 MD 2,984,661 1,434,923 166,589 MA 3,576,968 1,477,163 138,040 MI 4,558,811 3,792,277 235,879 MN 4,357,483 3,161,747 242,001 MS 768,337 1,018,781 1,941,055 MO 2,140,904 2,585,902 133,896 MT 487,160 492,624 29,021 NE 534,410 835,228 25,815 NV 981,343 880,929 70,634 NH 311,242 248,986 10,516 NJ 3,568,473 2,556,019 143,561 NM 781,024 477,514 131,785 NY 7,655,052 3,456,757 1,151,597 NC 1,771,061 1,846,041 46,224 ND 258,753 373,288 15,629 MP 0 5,199 9,150 OH 4,443,362 4,352,932 33,358 OK 428,452 730,531 19,853 OR 1,061,412 702,531 83,703 PA 5,808,723 4,623,205 121,407 RI 474,052 274,259 1,707 SC 758,340 927,494 23,458 SD 121,033 202,695 12,237 TN 1,831,900 2,507,138 64,527 TX 7,898,384 8,395,912 280,067 UT 702,550 1,282,522 130,331 VT 188,547 145,520 211,008 VI 16,341 0 264 VA 3,777,431 2,783,014 104,523 WA 3,691,957 2,182,548 233,614 WV 525,078 608,259 30,688 WI 2,840,406 2,305,928 86,084 WY 121,130 264,173 19,362 Total: 113,103,585 85,199,865 7,247,242",
  2020, "State Democratic Candidates Republican Candidates Other Candidates AL 2,378,911 4,249,258 63,217 AK 459,702 573,189 34,391 AS 1,959 9,790 0 AZ 5,017,928 4,937,863 55,101 AR 754,417 2,382,784 454,525 CA 22,194,873 11,647,185 384,223 CO 5,214,518 4,172,347 270,888 CT 2,103,623 1,391,367 101,794 DE 869,454 583,049 31,048 DC 599,154 18,586 53,203 FL 10,239,332 11,137,895 155,020 GA 14,178,589 14,251,807 289,574 GU 40,192 5,932 55 HI 720,892 352,079 28,033 ID 828,416 1,653,970 95,284 IL 10,106,332 7,183,690 589,442 IN 2,437,399 3,468,602 123,653 IA 2,276,191 2,622,087 172,147 KS 1,699,111 2,275,266 58,054 KY 2,324,150 3,923,925 139,645 LA 2,314,425 3,846,628 159,460 ME 1,251,273 1,118,618 78,015 MD 3,897,763 2,004,564 88,873 MA 7,222,607 3,043,968 255,621 MI 8,227,135 7,909,966 305,061 MN 4,837,972 4,357,030 490,234 MS 1,539,103 2,273,107 40,749 MO 2,425,149 3,444,468 129,766 MT 779,589 1,015,945 15,286 NE 927,792 1,725,587 174,314 NV 1,369,012 1,303,717 88,254 NH 1,289,610 1,045,934 53,677 NJ 7,688,826 5,543,492 190,702 NM 1,471,878 1,228,163 44,845 NY 9,973,499 5,948,788 921,660 NC 7,914,792 8,055,709 354,500 ND 213,131 481,145 23,547 MP 0 0 11,449 OH 5,130,665 6,402,721 145,356 OK 1,489,384 3,043,595 135,464 OR 3,946,769 2,838,048 218,942 PA 6,804,941 6,810,269 109,641 PR 0 0 1,246,092 RI 948,696 474,671 77,069 SC 3,279,168 4,166,924 87,783 SD 294,458 859,259 86,843 TN 3,289,939 5,378,656 186,761 TX 15,044,563 17,780,042 728,117 UT 1,066,228 1,738,487 115,806 VT 481,653 208,534 32,081 VI 13,620 0 1,867 VA 7,134,042 5,944,264 144,967 WA 4,709,968 3,130,087 191,809 WV 693,196 1,607,104 13,365 WI 3,197,537 3,271,583 66,972 WY 213,833 577,391 28,299 Total: 205,527,359 195,419,135 10,142,544",
  2022, "State Democratic Candidates Republican Candidates Other Candidates AL 755,286 1,884,547 118,115 AK 155,698 361,911 7,706 AS 0 6,637 0 AZ 2,326,489 2,521,269 84,614 AR 551,958 1,190,437 54,013 CA 20,003,695 12,215,116 52,965 CO 2,762,597 2,082,653 127,095 CT 1,413,998 1,057,330 49,910 DE 178,416 138,201 5,050 DC 174,238 11,701 15,391 FL 6,107,224 8,746,043 237,051 GA 5,630,620 5,673,788 81,379 GU 15,636 17,260 220 HI 562,847 230,449 16,395 ID 350,805 753,890 69,823 IL 4,600,497 3,469,837 77,967 IN 1,483,684 2,317,962 103,402 IA 1,059,790 1,359,358 9,198 KS 797,536 1,172,543 36,694 KY 1,055,232 1,866,622 19,394 LA 799,997 1,650,544 65,873 ME 372,827 270,523 22,208 MD 2,608,343 1,372,756 16,965 MA 1,636,400 706,790 14,807 MI 2,184,504 2,083,361 107,672 MN 1,250,518 1,200,855 44,459 MS 251,202 454,329 3,569 MO 1,667,672 2,370,583 90,964 MT 158,745 245,081 59,806 NE 235,572 414,599 13,016 NV 979,090 1,005,923 45,340 NH 671,517 553,439 13,565 NJ 1,416,422 1,160,260 33,034 NM 387,665 316,352 109 NY 6,050,937 4,437,619 1,126,408 NC 3,579,219 3,862,692 92,766 ND 59,995 283,873 134,858 MP 12,315 0 0 OH 3,730,103 4,511,107 1,843 OK 1,131,747 2,211,242 104,535 OR 2,089,149 1,640,982 104,758 PA 5,187,931 5,189,522 179,317 RI 201,750 150,024 6,049 SC 1,144,745 2,122,352 30,946 SD 91,007 496,137 88,717 TN 581,902 1,099,462 29,061 TX 2,999,053 4,559,280 193,428 UT 342,078 1,242,898 554,350 VT 373,069 158,865 37,192 VI 16,354 0 209 VA 1,572,296 1,462,049 13,294 WA 3,493,418 2,561,288 19,381 WV 149,706 312,004 10,372 WI 2,323,422 2,740,265 120,114 WY 47,250 132,206 14,446 Total: 99,784,166 100,056,816 4,559,813"
)

# String conversion
for (year in raw_text$year) {
  text <- raw_text$input[raw_text$year == year]
  chunks <- str_split(text, " ")[[1]]
  chunks <- chunks[8:length(chunks)]

  num_rows <- length(chunks) / 4

  raw_loc_vals <- chunks[1:num_rows * 4 - 3]
  loc_vals <- vector(length = num_rows)
  for (abbr in raw_loc_vals) {
    if (abbr != "Total:") {
      loc_vals[raw_loc_vals == abbr] <- abbr_conv$name[abbr_conv$abbr == abbr]
    }
  }
  loc_vals[num_rows] <- "United States"

  get_vals <- function(offset) {
    new_vals <- chunks[1:num_rows * 4 - offset]
    for (i in seq_len(num_rows)) {
      v <- new_vals[i]
      v <- str_remove_all(v, ",")
      new_vals[i] <- v
    }
    new_vals <- as.numeric(new_vals)
    return(new_vals)
  }

  other_vals <- get_vals(0)
  rep_vals <- get_vals(1)
  print(rep_vals[length(rep_vals)])
  dem_vals <- get_vals(2)

  # Putting it all together
  fed_elec <- tibble(
    locality = loc_vals,
    dem_votes = dem_vals,
    rep_votes = rep_vals,
    other_votes = other_vals
  )

  write_csv(fed_elec, str_c("raw_data/fed_elec", year, ".csv"))
}

#### PART 2: IMPORTS & NEW VARS ####
years_in_range <- 2004 + 0:9 * 2

fed_elec_comb <- tibble(
  locality = character(),
  year = numeric(),
  dem_votes = numeric(),
  rep_votes = numeric(),
  other_votes = numeric()
)

for (y in years_in_range) {
  data <- read_csv(str_c("raw_data/fed_elec", as.character(y), ".csv"))
  data <- mutate(data, year = y)
  fed_elec_comb <- rows_append(fed_elec_comb, data)
}

fed_elec_final <- fed_elec_comb %>%
  mutate(
    dem_margin = dem_votes - rep_votes - other_votes,
    dem_diff = dem_margin / (dem_votes + rep_votes + other_votes),
    swing_state = abs(dem_diff) < 0.05
  )

write_csv(fed_elec_final, str_c(
  "raw_data/fed_elec",
  as.character(min(years_in_range)),
  "-",
  as.character(max(years_in_range)),
  ".csv"
))